<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro - U-Mascota</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen flex items-center justify-center py-8">
    <div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md">
        <div class="text-center mb-8">
            <a href="/" class="text-3xl font-bold text-blue-600 mb-4 inline-block">
                <i class="fas fa-paw mr-2"></i>U-Mascota
            </a>
            <h1 class="text-2xl font-bold text-gray-800">Crear Cuenta</h1>
            <p class="text-gray-600 mt-2">√önete a nuestra comunidad de amantes de las mascotas</p>
        </div>

        <form id="registerForm" class="space-y-6">
            <div>
                <label class="block text-gray-700 font-medium mb-2">
                    <i class="fas fa-user mr-1 text-blue-500"></i>Nombre Completo
                </label>
                <input type="text" name="nombreCompleto" 
                       class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" 
                       placeholder="Ingresa tu nombre completo" required>
            </div>

            <div>
                <label class="block text-gray-700 font-medium mb-2">
                    <i class="fas fa-envelope mr-1 text-blue-500"></i>Correo Electr√≥nico
                </label>
                <input type="email" name="correoElectronico" 
                       class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" 
                       placeholder="tu@email.com" required>
            </div>

            <div>
                <label class="block text-gray-700 font-medium mb-2">
                    <i class="fas fa-lock mr-1 text-blue-500"></i>Contrase√±a
                </label>
                <input type="password" name="contrasena" 
                       class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" 
                       placeholder="M√≠nimo 6 caracteres" required>
            </div>

            <div>
                <label class="block text-gray-700 font-medium mb-2">
                    <i class="fas fa-phone mr-1 text-blue-500"></i>Tel√©fono (Opcional)
                </label>
                <input type="text" name="telefono" 
                       class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" 
                       placeholder="+57 300 123 4567">
            </div>

            <div>
                <label class="block text-gray-700 font-medium mb-2">
                    <i class="fas fa-map-marker-alt mr-1 text-blue-500"></i>Ciudad (Opcional)
                </label>
                <input type="text" name="ciudad" 
                       class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" 
                       placeholder="Tu ciudad">
            </div>

            <div>
                <label class="block text-gray-700 font-medium mb-2">
                    <i class="fas fa-users mr-1 text-blue-500"></i>Tipo de Usuario
                </label>
                <select name="tipoUsuario" 
                        class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                    <option value="ADOPTANTE">üêæ Adoptante - Quiero adoptar mascotas</option>
                    <option value="PUBLICADOR">üìù Publicador - Quiero publicar mascotas</option>
                </select>
            </div>

            <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg">
                <p class="text-blue-800 text-sm">
                    <i class="fas fa-info-circle mr-1"></i>
                    <strong>Adoptante:</strong> Puedes ver y adoptar mascotas disponibles.<br>
                    <strong>Publicador:</strong> Puedes publicar mascotas para adopci√≥n.
                </p>
            </div>

            <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-3 px-6 rounded-lg hover:from-blue-700 hover:to-indigo-700 font-medium transition-all transform hover:scale-105 shadow-lg">
                <i class="fas fa-user-plus mr-2"></i>Crear Cuenta
            </button>

            <div class="text-center">
                <p class="text-gray-600">
                    ¬øYa tienes cuenta? 
                    <a href="/login" class="text-blue-600 hover:text-blue-800 font-medium">Inicia sesi√≥n aqu√≠</a>
                </p>
            </div>
        </form>
    </div>

    <script>
    document.getElementById('registerForm').addEventListener('submit', async function(e) {
        e.preventDefault();

        // Mostrar loading
        const submitBtn = e.target.querySelector('button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Creando cuenta...';
        submitBtn.disabled = true;

        const data = {
            nombreCompleto: e.target.nombreCompleto.value,
            correoElectronico: e.target.correoElectronico.value,
            contrasena: e.target.contrasena.value,
            telefono: e.target.telefono.value,
            ciudad: e.target.ciudad.value,
            tipoUsuario: e.target.tipoUsuario.value
        };

        try {
            const response = await fetch('/auth/registro', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            const result = await response.text();

            if (response.ok) {
                alert("‚úÖ " + result);
                // Redirigir al login despu√©s del registro exitoso
                setTimeout(() => {
                    window.location.href = '/login';
                }, 1500);
            } else {
                alert("‚ö†Ô∏è Error: " + result);
            }
        } catch (error) {
            alert("‚ùå Error de conexi√≥n: " + error.message);
        } finally {
            // Restaurar bot√≥n
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        }
    });
    </script>
</body>
</html>
